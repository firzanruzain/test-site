<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meeting Scheduler</title>
    <link rel="icon" type="image/x-icon" href="../assets/main_logo.png">
    <link rel="stylesheet" href="../css/common-ui.css">
    <link rel="stylesheet" href="../css/proposal-management-style.css"> <!-- uses same css -->
    <link rel="stylesheet" href="../css/calendar-style.css">
    <link rel="stylesheet" href="../css/form-style.css">
</head>
<body>
    <div id="outer-container">
        <!-- Header Section -->
        <header>
            <div class="menubutton"><input title="side-menu" type="checkbox" id="user-side-menu"><label
                    for="user-side-menu" class="fas"></label></div>
            <div id="logo"></div>
            <button id="home"><a href="../user-management-mgt/user-dashboard-page.html"><img src="../assets/home.png" alt="home icon"></a></button>
        </header>
        <!-- Main Content -->
        <div class="container">
            <!-- Side Menu -->
            <nav id="side-menu">
                <div class="search-container">
                    <input type="text" id="search-bar" placeholder="Search">
                </div>
                <ul id="side-menu-shortcuts">

                    <!-- Dropdown List -->
                    <li class="side-menu-dropdown-list">
                        <button class="menu-button dropdown-button">
                            <span class="menu-label">User Management</span>
                            <span class="expand-icon"></span>
                        </button>

                        <!-- Inner Dropdown List -->
                        <ul class="inner-dropdown">
                            <li class="inner-dropdown-list"><a class="menu-button"
                                    href="../user-management-mgt/student-profile-mgt-page.html">Student Profile</a>
                            </li>

                            <li class="inner-dropdown-list"><a class="menu-button"
                                    href="../user-management-mgt/user-dashboard-page.html">Student Dashboard</a>
                            </li>

                            <li class="inner-dropdown-list"><a class="menu-button"
                                    href="../user-management-mgt/about-us-page.html">About Us</a>
                            </li>
                        </ul>
                    </li>

                    <li class="side-menu-dropdown-list">
                        <button onclick="location.href='../project-management-mgt/projectmanagement.html'"
                            class="menu-button"><span class="menu-label">Project Management</span>
                    </li>

                    <li class="side-menu-dropdown-list">
                        <button class="menu-button dropdown-button">
                            <span class="menu-label">Meeting & Presentation</span>
                            <span class="expand-icon"></span>
                        </button>

                        <!-- Inner Dropdown List -->
                        <ul class="inner-dropdown">
                            <li class="inner-dropdown-list"><a class="menu-button"
                                    href="../meeting-mgt/meeting-management-page.html">All Meetings</a>
                            </li>

                            <li class="inner-dropdown-list"><a class="menu-button"
                                    href="../meeting-mgt/meeting-scheduler-page.html">New Meeting</a>
                            </li>

                            <li class="inner-dropdown-list"><a class="menu-button"
                                    href="../meeting-mgt/meeting-log-page.html">New Meeting Log</a>
                            </li>

                            <li class="inner-dropdown-list"><a class="menu-button"
                                    href="../meeting-mgt/presentation-management-page.html">Presentation</a>
                            </li>
                        </ul>
                    </li>

                    <li class="side-menu-dropdown-list">
                        <button onclick="location.href='../communication/comm-page.html'" class="menu-button"><span
                                class="menu-label">Communication</span>
                    </li>
                </ul>
            </nav>

            <!-- Meeting Scheduler Form -->
            <div class="content">
                <h2 class="form-title">Meeting Scheduler</h2>
                <hr />
                <form class="form" id="meetingForm">
                    <!-- auto-generated Proposal ID -->
                    <div class="form-group">
                        <label for="meeting-id">Meeting ID</label>
                        <p id="meeting-id" class="meeting-id"></p>
                    </div>

                    <div class="form-group">
                        <label for="title">Meeting Title</label>
                        <input type="text" id="title" name="title" placeholder="Enter meeting title" required>
                    </div>

                    <div class="form-group">
                        <label for="description">Meeting Description</label>
                        <textarea id="description" name="description" rows="3" placeholder="Enter meeting description" required></textarea>    
                    </div>
                    
                    <div class="form-group">
                        <label for="date">Meeting Date</label>
                        <div class="calendar-section">
                            <!-- Calendar Header -->
                            <div class="calendar-header">
                                <button id="prev-month" class="nav-btn">&lt;</button>
                                <span id="month-display" class="month-display"></span>
                                <button id="next-month" class="nav-btn">&gt;</button>
                            </div>
                    
                            <!-- Calendar Table -->
                            <table>
                                <thead>
                                    <tr>
                                        <th>S</th>
                                        <th>M</th>
                                        <th>T</th>
                                        <th>W</th>
                                        <th>T</th>
                                        <th>F</th>
                                        <th>S</th>
                                    </tr>
                                </thead>
                                <tbody id="calendar"></tbody>
                            </table>
                        </div>
                        <!-- Hidden input to store selected date -->
                        <input type="hidden" id="date" name="date">
                    </div>

                    <div class="form-group">
                        <label for="time">Meeting Time</label>
                        <input type="time" id="time" name="time" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="participants">Select Participants</label>
                        <input type="text" id="participants" placeholder="Add participants">
                    </div>

                    <div class="form-group">
                        <label for="mode">Mode of Meeting</label>
                        <select id="mode" name="mode" required>
                            <option value="" disabled selected>Select Mode</option>
                            <option value="Online">Online</option>
                            <option value="Offline">Offline</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="location">Location</label>
                        <input type="text" id="location" placeholder="Enter location">
                    </div>
                    

                    <div class="form-group">
                        <label for="url">Meeting URL</label>
                        <input type="url" id="url" placeholder="Enter meeting URL">
                    </div>
                    
                    <!-- submit and reset buttons -->
                    <div class="form-buttons">
                        <button type="submit" class="btn submit-btn">Submit</button>
                        <button type="reset" class="btn reset-btn">Reset</button>
                    </div>
                </form>
            </div>
        </div>
        <footer>
            <h3><a href="https://www.mmu.edu.my/">Multimedia University, Persiaran Multimedia, 63100 Cyberjaya, Selangor,
                    Malaysia</a></h3>
            <div id="side">
                <a class="link" href="http://www.mmu.edu.my/">MMU Website</a>
                <a class="link" href="https://online.mmu.edu.my/">MMU Portal</a>
                <a class="link" href="https://clic.mmu.edu.my/">CLiC</a>
                <a class="link" href="https://servicedesk.mmu.edu.my/psp/crmprd/?cmd=login&languageCd=ENG&">Service Desk</a>
            </div>
            FYP Wise &copy; <em id="date"></em>Syabell Imran Aida Firzan
        </footer>
    </div>

    <script src="../scripts/calendar.js"></script>
    <script src="../scripts/side-menu.js"></script>
    <script>
        // function to auto-generate Meeting ID
        function generateMeetingID() {
            const prefix = "M";
            const maxID = 9999; // limit to P9999

            // retrieve the last Meeting ID from localStorage
            let lastID = localStorage.getItem("lastMeetingID");

            // if no lastID is found, start with "1"
            if (!lastID) {
                lastID = "1"; // Starting point if no ID exists yet
                localStorage.setItem("lastMeetingID", lastID);
            }

            // Increment the ID (parse with radix 10)
            let nextID = parseInt(lastID, 10) + 1;

            // Check if parsing was successful
            if (isNaN(nextID)) {
                console.error("Error: Unable to parse lastID into a number!");
                return `${prefix}1`; // Return a default value if error occurs
            }

            // Ensure the ID doesn't exceed the maxID
            if (nextID > maxID) {
                alert("Maximum Meeting ID reached!");
                return `${prefix}${maxID}`;
            }

            // Save the new ID back to localStorage
            localStorage.setItem("lastMeetingID", nextID.toString());

            // Return the full Proposal ID with the prefix
            return `${prefix}${nextID}`;
        }

        // assign auto-generated meeting ID every page load to simulate auto-generation
        window.onload = function () {
            const meetingIDField = document.getElementById("meeting-id");
            if (meetingIDField) {
                meetingIDField.textContent = generateMeetingID();
            }
        };
        
        // form submission demo
        document.getElementById("meetingForm").addEventListener("submit", function(event) {
            event.preventDefault(); // prevent actual form submission, only for display
            
            // retrieve form data
            const formData = {
                meetingID: document.getElementById("meeting-id").textContent,
                title: document.getElementById("title").value,
                description: document.getElementById("description").value,
                date: document.getElementById("date").value,
                time: document.getElementById("time").value,
                participants: document.getElementById("participants").value,
                mode: document.getElementById("mode").value,
                location: document.getElementById("location").value,
                url: document.getElementById("url").value
            };

            // display submitted meeting data in an alert
            let displayMessage = `
                Meeting ID: ${formData.meetingID}
                Meeting Title: ${formData.title}
                Description: ${formData.description}
                Meeting Date: ${formData.date}
                Meeting Time: ${formData.time}
                Participants: ${formData.participants}
                Mode: ${formData.mode}
                Location: ${formData.location}
                URL: ${formData.url}
            `;

            // show the form data in a pop-up message
            alert(`Meeting scheduled successfully!\n\n${displayMessage}`);

            // reload page after successful submission
            location.reload();
        });
    </script>
</body>
</html>
